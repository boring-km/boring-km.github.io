
> 객체지향 패러다임
> - 객체지향의 본질은 협력하는 객체들의 공동체를 창조하는 것이다.
> 객체지향 설계의 핵심은 협력을 구성하기 위해 적절한 객체를 찾고 적절한 책임을 할당하는 과정에서 드러난다.
> - 객체지향에서 가장 중요한 것은 **역할, 책임, 협력**이다.

## 협력(collaboration)
- 의미: 객체들이 애플리케이션의 기능을 구현하기 위해 수행하는 상호작용
  - 객체가 **협력**에 참여하기 위해 수행하는 로직을 **책임**이라고 한다.
  - 객체들이 **협력** 안에서 수행하는 책임들이 모여 객체가 수행하는 **역할**을 구성한다.

### 메시지 전송(message sending)
- 의미: 객체 사이의 협력을 위해 사용할 수 있는 유일한 커뮤니케이션 수단이다.
- 객체는 다른 객체의 상세한 내부 구현에 직접 접근할 수 없기 때문에 오직 메시지 전송을 통해 자신의 요청을 전달한다.
- 메시지를 수신한 객체는 메서드를 실행해 요청에 응답한다.

### 협력이 설계를 위한 문맥을 결정한다
- **협력**이 바뀌면 객체가 제공해야 하는 **행동** 역시 바뀌어야 한다.
- **상태**는 객체가 행동하는 데 필요한 정보에 의해 결정되고 행동은 협력 안에서 객체가 처리할 메시지로 결정된다.
- 협력은 객체를 설계하는 데 필요한 일종의 문맥(context)을 제공한다.

![챕터1](/assets/chapter3/chapter1.png)
![챕터2](/assets/chapter3/chapter2.png)

## 책임
- 의미: 객체에 의해 정의되는 응집도 있는 행위의 집합으로, 객체가 유지해야 하는 정보와 수행할 수 있는 행동에 대해 개략적으로 서술한 문장이다.
<br>
- **하는 것[doing]**
  - 객체를 생성하거나 계산을 수행하는 등의 스스로 하는 것
  - 다른 객체의 행동을 시작시키는 것
  - 다른 객체의 활동을 제어하고 조절하는 것
- **아는 것[knowing]**
  - 사적인 정보에 관해 아는 것
  - 관련된 객체에 관해 아는 것
  - 자신이 유도하거나 계산할 수 있는 것에 관해 아는 것
<br>
- 단순한 **책임**이 여러 개의 메시지로 분할되기도 한다.
- 하나의 객체로 수행할 수 있다고 생각한 **책임**이 나중에는 여러 객체들이 협력해야만 하는 **커다란 책임**으로 자라는 것이 일반적이다.

### CRC 카드
- 후보(Candidate), 책임(Responsibility), 협력자(Collaborator)
- 선이 없는 면에는 하나의 **후보**와 **목적**(후보가 외부에 제공해야 하는 서비스)을 기술한다.
- 선이 있는 면에는 아래와 같이 적는다.
<br>
![CRC 카드](/assets/chapter3/crc1.png)
<br>
  - 책임에 해당하는 내용이 각각 아는 것과 하는 것으로 표현되어 있는 것도 같이 확인할 수 있었다.
  - CRC 카드는 역할을 식별하고, 책임을 할당하며, 협력을 명시적으로 표현하는 구체적이면서도 실용적인 설계 기법이다.

### 책임 할당
- **정보 전문가(Information Expert)** 패턴: 책임을 수행하는 데 필요한 정보를 가장 잘 알고 있는 전문가에게 책임을 할당함
- 책임을 할당한다 == 메시지의 이름을 결정한다
  - chapter1에서 Theater에서 표를 판매하는 역할은 TicketSeller

### 책임 주도 설계
  - 의미: **책임을 찾고** 책임을 수행할 적절한 객체를 찾아 **책임을 할당**하는 방식으로 협력을 설계하는 방법
  > 1. 시스템이 사용자에게 제공해야 하는 기능인 시스템 책임을 파악한다.
  > 2. 시스템 책임을 더 작은 책임으로 분할한다.
  > 3. 분할된 책임을 수행할 수 있는 적절한 객체 또는 역할을 찾아 책임을 할당한다.
  > 4. 객체가 책임을 수행하는 도중 다른 객체의 도움이 필요한 경우 이를 책임질 적절한 객체 또는 역할을 찾는다.
  > 5. 해당 객체 또는 역할에게 책임을 할당함으로써 두 객체가 협력하게 한다.

### 메시지가 객체를 결정한다
- 객체에게 책임을 할당하는 데 필요한 **메시지를 먼저** 식별하고 메시지를 처리할 **객체를 나중에** 선택했다는 것이 중요하다.
> #### 메시지가 객체를 선택하게 해야 하는 이유
> 1. 객체가 최소한의 인터페이스를 가질 수 있게 된다.
> 2. 객체는 충분히 추상적인 인터페이스를 가질 수 있게 된다.

### 행동이 상태를 결정한다
- **초보자의 실수: 객체의 행동이 아니라 상태에 초점을 맞춘다.**
> - **캡슐화를 저해한다**: 객체의 내부 구현이 객체의 public interface에 노출되도록 만들기 때문
> - 객체의 내부 구현을 변경하면 public interface도 함께 변경되고, 결국 객체에 의존하는 클라이언트로 변경의 영향이 전파된다.
> - 데이터-주도 설계(Data-Driven Design)
- **캡슐화**를 위반하지 않도록 구현에 대한 결정을 뒤로 미루면서 **객체의 행위**를 고려하기 위해서 항상 **협력**이라는 문맥 안에서 객체를 생각해야 한다.
- 협력 관계 속에서 **다른 객체에게 무엇을 제공**해야 하고 **다른 객체로부터 무엇을 얻어야 하는지**를 고민해야만 훌륭한 책임을 수확할 수 있다.

## 역할
- 의미: 객체가 어떤 특정한 협력 안에서 수행하는 책임의 집합
- 영화 예매 협력에서 예매하라는 메시지를 처리
  > 1. 영화를 예매할 수 있는 적절한 역할이 무엇인지 찾음
  > 2. 역할을 수행할 객체로 Screening 인스턴스를 선택

### 유연하고 재사용 가능한 협력을 얻음
- 객체가 아닌 책임에 초점을 맞춰야 한다.
- *할인 요금을 계산하라* 라는 메시지에 응답할 수 있는 **대표자**를 생각해서 **협력들을 하나로 통합**
  - 이 대표자를 협력 안에서 두 종류의 객체를 교대로 바꿔 끼울 수 있는 슬롯 => **역할**
- **책임과 역할을 중심으로 협력을 바라보는 것**이 변경과 확장이 용이한 유연한 설계로 이끈다.

#### 역할의 구현
- 방법: 추상 클래스나 인터페이스 사용하여 역할을 정의함
- 추상 클래스: 책임의 일부를 구현해 놓음 - **템플릿 메서드 패턴?**
- 인터페이스: 일체의 구현 없이 책임의 집합만을 나열해 놓음 **전략 패턴?**

### 객체 대 역할
- 다양한 객체들이 협력에 참여한다는 것이 확실하면 역할로 시작하자
- 정확한 결정을 내리기 어렵다면 구체적인 객체로 시작하자
<br>
![협력, 역할, 객체, 클래스](/assets/chapter3/image3.5.png)
<br>
>  - 협력은 역할의 상호작용으로 구성
>  - 역할에 적합한 객체를 선택
>  - 객체는 클래스를 이용해 구현되고 생성

- 협력을 구체적인 객체가 아니라 **추상적인 역할의 관점**에서 설계하자

### 역할과 추상화
- 역할은 공통의 책임을 바탕으로 객체의 종류를 숨기기 때문에 이런 관점에서 역할을 객체의 추상화로 볼 수 있다.
> 추상화의 장점을 역할에도 동일하게 적용
> 1. 세부 사항에 억눌리지 않고도 상위 수준의 정책을 쉽고 간단하게 표현할 수 있다. (핵심개념 강조)
> - 2장에서 세부적인 할인 정책과 할인 조건을 인터페이스를 통해 추상화에 집중할 수 있도록 함
> 2. 설계를 유연하게 만들 수 있음
> - 협력 안에서 동일한 책임을 수행하는 객체들은 동일한 역할을 수행하기 때문에 서로 대체 가능하다.
> - 따라서 역할은 다양한 환경에서 다양한 객체들을 수용할 수 있게 해주므로 협력을 유연하게 만든다.

### 배우와 배역 비유
> 연극의 배역과 배우 간의 관계
> - 배역은 연극 배우가 특정 연극에서 연기하는 역할이다.
> - 배역은 연극이 상영되는 동안에만 존재하는 일시적인 개념이다.
> - 연극이 끝나면 연극 배우는 배역이라는 역할을 벗어 버리고 원래의 연극 배우로 돌아온다.
> - 동일한 배역을 서로 다른 배우들이 연기할 수 있다.
> - 하나의 배우가 다양한 연극 안에서 서로 다른 배역을 연기할 수 있다.

> 비유에 대한 해석
> - **협력은 연극**
> - **코드**는 극본
> - 객체는 **협력**이라는 실행 문맥 안에서 특정 **역할을 수행** => 배우는 연극이 상영될 때 배역이라는 특정 역할을 연기함
> - 객체는 **협력**이 끝나고 협력에서의 **역할을 잊고** 원래의 객체로 돌아올 수 있다. => 연극 배우는 연극이 끝나면 자신의 배역을 잊고 원래의 자기 자신을 되찾는다.

- **역할**은 특정한 협력에 참여해서 **책임을 수행**하는 객체의 일부다.
- **역할**은 모양이나 구조에 의해 정의될 수 없으며 오직 시스템의 문맥 안에서 **무엇을 하는지**에 의해서만 정의될 수 있다.
- 객체는 다양한 역할을 가질 수 있지만 협력에 참여할 때는 오직 하나의 역할만이 보여져야 한다.

## 질문
- 역할은 특정한 객체의 종류를 캡슐화하기 때문에 동일한 역할을 수행하고 계약을 준수하는 대체 가능한 객체들은 다형적이다.
- 디자인 패턴
